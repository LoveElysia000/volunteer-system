# Generated with protoc-gen-openapi
# https://github.com/google/gnostic/tree/master/cmd/protoc-gen-openapi

openapi: 3.0.3
info:
    title: WorkHourService API
    description: 工时流水服务接口
    version: 0.0.1
paths:
    /api/work-hours/list:
        post:
            tags:
                - WorkHourService
            description: 工时流水查询
            operationId: WorkHourService_WorkHourLogList
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/workhour.WorkHourLogListRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/workhour.WorkHourLogListResponse'
    /api/work-hours/recalculate:
        post:
            tags:
                - WorkHourService
            description: 工时重算
            operationId: WorkHourService_RecalculateWorkHour
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/workhour.RecalculateWorkHourRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/workhour.RecalculateWorkHourResponse'
    /api/work-hours/void:
        post:
            tags:
                - WorkHourService
            description: 工时作废
            operationId: WorkHourService_VoidWorkHour
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/workhour.VoidWorkHourRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/workhour.VoidWorkHourResponse'
components:
    schemas:
        workhour.RecalculateWorkHourRequest:
            type: object
            properties:
                signupId:
                    type: string
                    description: '报名ID 必填 @gotags: json:"signupId,required"'
                hours:
                    type: number
                    description: '重算工时（小时）可选；<=0则按签到签退时间自动计算 @gotags: json:"hours"'
                    format: double
                reason:
                    type: string
                    description: '重算原因 必填 @gotags: json:"reason,required"'
                idempotencyKey:
                    type: string
                    description: '幂等键 必填 @gotags: json:"idempotencyKey,required"'
        workhour.RecalculateWorkHourResponse:
            type: object
            properties:
                success:
                    type: boolean
                    description: 是否成功
                workHourLogId:
                    type: string
                    description: 本次重算写入的工时流水ID
                grantedHours:
                    type: number
                    description: 重算后发放工时
                    format: double
        workhour.VoidWorkHourRequest:
            type: object
            properties:
                signupId:
                    type: string
                    description: '报名ID 必填 @gotags: json:"signupId,required"'
                reason:
                    type: string
                    description: '作废原因 必填 @gotags: json:"reason,required"'
                idempotencyKey:
                    type: string
                    description: '幂等键 必填 @gotags: json:"idempotencyKey,required"'
        workhour.VoidWorkHourResponse:
            type: object
            properties:
                success:
                    type: boolean
                workHourLogId:
                    type: string
        workhour.WorkHourLogItem:
            type: object
            properties:
                id:
                    type: string
                    description: 工时流水ID
                volunteerId:
                    type: string
                    description: 志愿者ID（volunteers.id）
                activityId:
                    type: string
                    description: 活动ID
                signupId:
                    type: string
                    description: 报名ID
                operationType:
                    type: integer
                    description: '操作类型: 1-发放,2-作废,3-重发'
                    format: int32
                hoursDelta:
                    type: number
                    description: 工时增量（作废时为负数）
                    format: double
                serviceCountDelta:
                    type: string
                    description: 服务次数增量
                beforeTotalHours:
                    type: number
                    description: 变更前累计工时
                    format: double
                afterTotalHours:
                    type: number
                    description: 变更后累计工时
                    format: double
                beforeServiceCount:
                    type: string
                    description: 变更前累计服务次数
                afterServiceCount:
                    type: string
                    description: 变更后累计服务次数
                workHourVersion:
                    type: string
                    description: 工时结算版本号
                refLogId:
                    type: string
                    description: 关联原流水ID（作废/重发场景）
                reason:
                    type: string
                    description: 备注原因
                operatorId:
                    type: string
                    description: 操作人账号ID
                idempotencyKey:
                    type: string
                    description: 幂等键
                createdAt:
                    type: string
                    description: 创建时间
        workhour.WorkHourLogListRequest:
            type: object
            properties:
                page:
                    type: integer
                    description: '页码 可选 @gotags: query:"page"'
                    format: int32
                pageSize:
                    type: integer
                    description: '页大小 可选 @gotags: query:"pageSize"'
                    format: int32
                activityId:
                    type: string
                    description: '活动ID 可选 @gotags: json:"activityId"'
                signupId:
                    type: string
                    description: '报名ID 可选 @gotags: json:"signupId"'
                operationType:
                    type: integer
                    description: '操作类型: 1-发放,2-作废,3-重发 可选 @gotags: json:"operationType"'
                    format: int32
        workhour.WorkHourLogListResponse:
            type: object
            properties:
                total:
                    type: integer
                    format: int32
                list:
                    type: array
                    items:
                        $ref: '#/components/schemas/workhour.WorkHourLogItem'
tags:
    - name: WorkHourService
